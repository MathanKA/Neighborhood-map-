<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Neighborhood Map</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        <link href='http://fonts.googleapis.com/css?family=Raleway:400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div id="map-canvas"></div>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-offset-5 col-md-2">
                    <div class="loading-box" data-bind="visible: loading">
                        <span>Loading ...</span>
                    </div>
                    <div style="display: none" class="error-box" data-bind="visible: error">
                        <!-- <span>An error occured. Please reload the page.</span> -->
                        <p data-bind="text: errorText"></p>
                    </div>
                    <div style="display: none" class="message-box" data-bind="visible: !hasPlaces()">
                        <span>No places found around </span><span data-bind="text: neighborhood.name"></span></span>.</span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="neighborhood-selector">
                        <input type="text" class="form-control" id="neighborhood" data-bind="attr: { placeholder: 'Neighborhood: ' + neighborhood.name() }, value: switchInputValue">
                    </div>
                </div>
                <div class="col-md-offset-5 col-md-4">
                    <div class="sidebar">
                        <a class="hide-list-view">
                            <div class="sidebar-title">
                                <h2>Places</h2>
                            </div>
                        </a>
                        <div class="filter-box">
                            <input class="form-control input-lg" type="text" placeholder="Search (e.g fast-food, ... or type a place name)" data-bind="textInput: searchInputValue">
                        </div>
                        <div id="list-view" class="list-view">
                            <ul class="categories" data-bind="foreach: categories">
                                <li class="category" data-bind="visible: placesMatchingQuery().length > 0">
                                    <a data-toggle="collapse" data-bind="attr: { href: '#' + id, 'aria-controls': id }" data-parent="#list-view" aria-expanded="true">
                                        <div class="category-header" data-bind="style: { backgroundColor: colors[id] }">
                                            <span class="category-icon">
                                                <img data-bind="attr: { src: headerIcon, alt: name }">
                                            </span>
                                            <div class="category-title" data-toggle="tooltip" data-placement="bottom" data-bind="attr: { title: pluralName }">
                                                <h4 data-bind="text: displayName"></h4>
                                            </div>
                                            <div class="toggle-visibility">
                                                <span class="glyphicon glyphicon-eye-open" data-bind="visible: isVisible, click: toggleVisibility" aria-hidden="true"></span>
                                                <span class="glyphicon glyphicon-eye-close" data-bind="visible: isHidden, click: toggleVisibility" aria-hidden="true"></span>
                                            </div>
                                        </div>
                                    </a>
                                    <ul style="display: none" class="places collapse in" data-bind="attr: { id: id }, visible: isVisible, foreach: places">
                                        <li class="place" data-bind="attr: { id: id }, css: { activated: infoWindowOpened }, visible: matchesQuery">
                                            <div class="row" data-bind="click: toggleInfoWindow">
                                                <div class="col-xs-3">
                                                    <img class="img-responsive place-thumbnail" data-bind="visible: photos.length > 0, attr: { src: thumbnail }" alt="thumbnail">
                                                    <img class="img-responsive place-thumbnail" data-bind="visible: photos.length <= 0, attr: { src: 'http://placehold.it/100/3f51b5/ffffff&text=' + name.charAt(0).toUpperCase() }" alt="thumbnail">
                                                </div>
                                                <div class="col-xs-9">
                                                    <h4 data-bind="text: name"></h4>
                                                    <h5 data-bind="text: formattedCategories"></h5>
                                                    <address data-bind="visible: location.formattedAddress.length > 0, foreach: location.formattedAddress">
                                                        <span data-bind="text: $data"></span><br>
                                                    </address>
                                                    <div class="place-more" data-bind="visible: infoWindowOpened">
                                                        <a href="#" data-bind="visible: photos.length > 0, click: function () { $('#photos-' + id).modal('show'); }, clickBubble: false">Photos</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal fade" data-bind="attr: { id: 'photos-' + id, 'aria-labelledby': 'modal-' + id }" tabindex="-1" role="dialog" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            <h4 class="modal-title" data-bind="text: name, attr: { id: 'modal-' + id }"></h4>
                                                        </div>
                                                        <div class="modal-body">
                                                            <div data-bind="attr: { id: 'slide-' + id }" class="carousel slide" data-ride="carousel">
                                                                <ol class="carousel-indicators" data-bind="foreach: photos">
                                                                    <li data-bind="css: { 'active': position == 0 }, attr: { 'data-target': '#slide-' + placeId, 'data-slide-to': $index }"></li>
                                                                </ol>
                                                                <div class="carousel-inner" role="listbox" data-bind="foreach: photos">
                                                                    <div class="item" data-bind="css: { 'active': position == 0 }">
                                                                        <img class="img-responsive" data-bind="attr: { src: preview }" alt="Preview">
                                                                    </div>
                                                                </div>
                                                                <a class="left carousel-control" data-bind="attr: { href: '#slide-' + id }" role="button" data-slide="prev">
                                                                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                                                    <span class="sr-only">Previous</span>
                                                                </a>
                                                                <a class="right carousel-control" data-bind="attr: { href: '#slide-' + id }" role="button" data-slide="next">
                                                                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                                                    <span class="sr-only">Previous</span>
                                                                </a>
                                                            </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div id="collapse-list-view">
                            <span id="collapse-list-view-button" class="glyphicon glyphicon-chevron-up"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="lib/modernizr/modernizr.js"></script>
        <script src="lib/jquery/jquery.min.js"></script>
        <script src="lib/bootstrap/js/bootstrap.min.js"></script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDPRKzksdR2_1Aidnsj8oAk5YIh7xEX0h0&libraries=places"></script>
        <script src="lib/knockout/knockout.js"></script>
        <script src="js/values.js"></script>
        <script src="js/apis.js"></script>
        <script src="js/app.js"></script>
        <script>
            // Toggle the visibility of the list view.
            var listView = $('.list-view');
            var listViewVisible = true;
            var collapse = $('#collapse-list-view');

            collapse.click(function () {
                listViewVisible = !listViewVisible;
                // $('.list-view').css('display', listViewVisible ? 'block' : 'none');

                var button = $('#collapse-list-view-button');

                if (listViewVisible) {
                    listView.slideDown();

                    button.removeClass('glyphicon-chevron-down');
                    button.addClass('glyphicon-chevron-up');

                    collapse.attr('title', 'Hide the list view.');
                } else {
                    listView.slideUp();

                    button.removeClass('glyphicon-chevron-up');
                    button.addClass('glyphicon-chevron-down');

                    collapse.attr('title', 'Show the list view.');
                }
            });
        </script>
    </body>
</html>
